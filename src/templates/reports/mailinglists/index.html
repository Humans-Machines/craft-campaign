{% extends 'campaign/reports/_layout' %}

{% set title = 'Mailing Lists'|t('campaign') %}

{% set crumbs = [] %}

{% set data = craft.campaign.getMailingListsReportData('mailingLists') %}


{% block content %}

    {% if data.mailingLists|length %}
        <div class="report-chart">
            <div class="spinner big"></div>
            <div id="chart"></div>
        </div>

        {% js %}
            new Campaign.Chart({
                action: 'campaign/reports/get-mailing-lists-chart-data'
            }).getChart();
        {% endjs %}
    {% endif %}

    <h2>{{ "Mailing Lists Overview"|t('campaign') }}</h2>

    <table class="data fullwidth collapsible">
        <tbody>
            <tr>
                <th class="light">{{ 'Total'|t('campaign') }}</th>
                <td>{{ data.mailingLists|length }}</td>
            </tr>
            <tr>
                <th class="light">{{ 'Subscribed'|t('campaign') }}</th>
                <td>{{ data.subscribed }}</td>
            </tr>
            <tr>
                <th class="light">{{ 'Unubscribed'|t('campaign') }}</th>
                <td>{{ data.unsubscribed }}</td>
            </tr>
            <tr>
                <th class="light">{{ 'Complained'|t('campaign') }}</th>
                <td>{{ data.complained }}</td>
            </tr>
            <tr>
                <th class="light">{{ 'Bounced'|t('campaign') }}</th>
                <td>{{ data.bounced }}</td>
            </tr>
        </tbody>
    </table>

    <br/><br/>

    {% if data.mailingLists|length %}
        <table id="mailingLists" class="data fullwidth collapsible">
            <thead>
            <th scope="col">{{ "Title"|t('app') }}</th>
            <th scope="col">{{ "Subscribed"|t('campaign') }}</th>
            <th scope="col">{{ "Unubscribed"|t('campaign') }}</th>
            <th scope="col">{{ "Complained"|t('campaign') }}</th>
            <th scope="col">{{ "Bounced"|t('campaign') }}</th>
            </thead>
            <tbody>
            {% for mailingList in data.mailingLists %}
                <tr>
                    <th scope="row" data-title="{{ 'Title'|t('app') }}"><a href="{{ mailingList.reportUrl }}">{{ mailingList.title }}</a></th>
                    <td data-title="{{ 'Subscribed'|t('campaign') }}">{{ mailingList.subscribedCount }}</td>
                    <td data-title="{{ 'Unsubscribed'|t('campaign') }}">{{ mailingList.unsubscribedCount }}</td>
                    <td data-title="{{ 'Complained'|t('campaign') }}">{{ mailingList.complainedCount }}</td>
                    <td data-title="{{ 'Bounced'|t('campaign') }}">{{ mailingList.bouncedCount }}</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>

    {% else %}

        <p>{{ "No mailing lists have been sent."|t('campaign') }}</p>

    {% endif %}

    <br/><br/>

{% endblock %}
